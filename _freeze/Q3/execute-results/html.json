{
  "hash": "5241e5d02794982b8ed15062714da6ad",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"IOT Network Intrusion Detection Analysis\"\nsubtitle: \"Q3 : Which combinations of dimensions is responsible for the different type of attack ?\"\nauthor: \n  - name: \"Team ViZZards\"\n    affiliations:\n      - name: \"School of Information, University of Arizona\"\ndescription: \"This project aims to analyze and visualize network attacks within Internet of Things (IoT) environments using the RT-IoT 2022 dataset, which includes network traffic data from both normal and malicious activities across various IoT devices. By examining metrics like protocol usage, bandwidth, payload size, and flow characteristics, the study seeks to identify distinctive patterns associated with different types of attacks. These insights will contribute to developing more effective intrusion detection strategies, enhancing cybersecurity within IoT systems. Ethical considerations are minimal, as the dataset excludes sensitive information.\"\n\nformat:\n  html:\n    code-tools: true\n    code-overflow: wrap\n    code-line-numbers: true\n    embed-resources: true\ntoc: true\neditor: visual\ncode-annotations: hover\nexecute:\n  warning: false\n  error: false\n  message: false\n---\n\n\n\n## Libraries and Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(pacman)) \n  install.packages(\"pacman\")\n\npacman::p_load(\n  # Core data manipulation and visualization\n  tidyverse,\n  glue,\n  scales,\n  ggplot2,\n  grid,\n  readr,\n  corrplot,\n  dplyr,\n  \n  \n  # Additional visualization packages\n  viridis,\n  RColorBrewer,\n  \n  # Data manipulation\n  data.table,\n  tibble,\n  \n  # Additional utilities\n  stringr,\n  lubridate,\n  forcats,\n  purrr,\n  tidyr,\n  magrittr\n)\n```\n:::\n\n\n\n## Dataset\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read_csv(\"data/data.csv\")\n\n# Assign distinct colors to each attack type\nunique_attacks <- unique(data$Attack_type)\nattack_colors <- hue_pal()(length(unique_attacks))\n\n# Filter dataset to exclude NMAP attacks\nfiltered_data <- data %>%\n  filter(!grepl(\"NMAP\", Attack_type, ignore.case = TRUE))\n```\n:::\n\n\n\n## Bandwidth Analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove extreme outliers (top 1%)\nbandwidth_data <- filtered_data %>%\n  filter(flow_pkts_per_sec < quantile(flow_pkts_per_sec,\n                                      0.99,\n                                      na.rm = TRUE))\n\n# Create the boxplot with improved scaling and layout\nggplot(bandwidth_data, aes(x = Attack_type, \n                           y = flow_pkts_per_sec, \n                           fill = Attack_type)) +\n  geom_boxplot(outlier.shape = NA) + # Suppress individual outliers \n  scale_fill_manual(values = attack_colors) + # Custom colors for attack types\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10), # Adjust x-axis\n    axis.title = element_text(size = 12),\n    legend.position = \"right\"\n  ) +\n  scale_y_log10(labels = scales::comma) + # Apply log10 scale \n  labs(\n    title = \"Flow Packets per Second by Attack Type (Bandwidth Analysis)\",\n    x = \"Attack Type\",\n    y = \"Flow Packets per Second (Log Scale)\",\n    fill = \"Attack Type\"\n  )\n```\n\n::: {.cell-output-display}\n![](Q3_files/figure-html/Badwidth Analysis-1.png){width=672}\n:::\n:::\n\n\n\n### Analysis :-\n\n**Variable Interaction:**\n\nHigh values of flow_pkts_per_sec (e.g., in DOS_SYN_Hping) indicate rapid packet flooding, overwhelming network bandwidth. Other attack types, like DDOS_Slowloris, exhibit low and steady flow packet rates, emphasizing a strategic, resource-depleting attack style.\n\n**Inference:**\n\nAttacks like DOS_SYN_Hping utilize high-bandwidth strategies, while others like ARP_poisoning rely on precise, low-rate operations. This interaction suggests that bandwidth-intensive attacks overwhelm network resources rapidly, while low-rate attacks focus on exploiting system vulnerabilities.\n\n## Inter-Arrival Time Analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove extreme outliers (top 1%)\niat_data <- filtered_data %>%\n  filter(fwd_iat.avg < quantile(fwd_iat.avg, 0.99, na.rm = TRUE))\n\n# Create the boxplot with improved formatting and log scale\nggplot(iat_data, aes(x = Attack_type, y = fwd_iat.avg, fill = Attack_type)) +\n  geom_boxplot(outlier.shape = NA) + # Suppress individual outliers\n  scale_fill_manual(values = attack_colors) + # Custom colors for attack types\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10), \n    axis.title = element_text(size = 12),\n    legend.position = \"right\"\n  ) +\n  scale_y_log10(labels = scales::comma) + # Apply log10 scale for y-axis\n  labs(\n    title = \"Average Forward Inter-Arrival Time by Attack Type\",\n    x = \"Attack Type\",\n    y = \"Forward Inter-Arrival Time (Log Scale)\",\n    fill = \"Attack Type\"\n  )\n```\n\n::: {.cell-output-display}\n![](Q3_files/figure-html/Inter-Arrival Time Analysis-1.png){width=672}\n:::\n:::\n\n\n\n### Analysis :-\n\n**Variable Interaction:**\n\nfwd_iat.avg (average inter-arrival time) and its distribution differ across attack types.\n\nDDOS_Slowloris shows high inter-arrival times, reflecting deliberate delays.\n\nMQTT_Publish exhibits tightly packed inter-arrival times, indicating efficient payload delivery.\n\n**Inference:**\n\nSlowloris attacks exploit resource-holding behaviors with prolonged intervals, interacting with server timeout mechanisms.\n\nLow inter-arrival time attacks (e.g., MQTT_Publish) use speed to avoid detection and maximize payload delivery, highlighting temporal manipulation as a key tactic.\n\n## Payload Behavior Analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove extreme outliers (top 1%)\npayload_data <- filtered_data %>%\n  filter(fwd_pkts_payload.avg < quantile(fwd_pkts_payload.avg, \n                                         0.99,\n                                         na.rm = TRUE))\n\n# Create the boxplot with focused y-axis range\nggplot(payload_data, aes(x = Attack_type,\n                         y = fwd_pkts_payload.avg,\n                         fill = Attack_type)) +\n  geom_boxplot(outlier.shape = NA) + # Suppress individual outliers\n  scale_fill_manual(values = attack_colors) + # Custom colors for attack types\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, \n                               hjust = 1, \n                               size = 10), \n    axis.title = element_text(size = 12),\n    legend.position = \"right\",\n    legend.title = element_text(size = 12),\n    legend.text = element_text(size = 10)\n  ) +\n  coord_cartesian(ylim = c(10, 100)) + # Focus on y-axis range 10 to 100\n  labs(\n    title = \"Average Forward Packets Payload by Attack Type (Focused Range)\",\n    x = \"Attack Type\",\n    y = \"Forward Packets Payload (Average)\",\n    fill = \"Attack Type\"\n  )\n```\n\n::: {.cell-output-display}\n![](Q3_files/figure-html/Payload Behavior Analysis-1.png){width=672}\n:::\n:::\n\n\n\n### Analysis:-\n\n**Variable Interaction:**\n\nVariables like fwd_pkts_payload.avg and fwd_pkts_payload.max interact to characterize payload distribution.\n\nWipro_bulb shows a wide payload range, indicating varied message sizes, while DDOS_Slowloris clusters at smaller payloads.\n\n**Inference:**\n\nLarger payload ranges indicate dynamic and adaptable attacks (e.g., Wipro_bulb), while smaller ranges (e.g., Slowloris) rely on consistent patterns to exhaust resources.\n\nPayload variability can be a signature of attack intent (e.g., reconnaissance vs. volumetric).\n\n## Heatmaps for Each Attack Type\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select only bandwidth, packet size, and flow-related variables\nheatmap_vars <- c(\n  \"fwd_pkts_tot\", \"bwd_pkts_tot\", \"fwd_data_pkts_tot\", \"bwd_data_pkts_tot\",\n  \"fwd_pkts_per_sec\", \"bwd_pkts_per_sec\", \"flow_pkts_per_sec\",\n  \"fwd_pkts_payload.avg\", \"fwd_pkts_payload.min\", \"fwd_pkts_payload.max\",\n  \"flow_duration\"\n)\n\n# Loop through each unique attack type\nfor (attack in unique(filtered_data$Attack_type)) {\n  # Filter data for the specific attack type\n  attack_data <- filtered_data %>% filter(Attack_type == attack)\n  \n  # Ensure there are enough observations to compute correlations\n  if (nrow(attack_data) < 5) next\n  \n  # Subset only the relevant columns present in attack_data\n  relevant_vars <- intersect(heatmap_vars, names(attack_data))\n  \n  # Remove variables with constant values or too many missing values\n  valid_vars <- sapply(attack_data[, relevant_vars, drop = FALSE], function(col) {\n    var(col, na.rm = TRUE) > 0 & sum(is.na(col)) / length(col) < 0.5\n  })\n  \n  # Subset the attack_data to valid variables only\n  attack_data <- attack_data[, names(valid_vars)[valid_vars], drop = FALSE]\n  \n  # Calculate correlation matrix, excluding NA values\n  if (ncol(attack_data) > 1) {\n    corr_matrix <- cor(attack_data, use = \"pairwise.complete.obs\")\n    \n    # Replace NA correlations with 0 (optional)\n    corr_matrix[is.na(corr_matrix)] <- 0\n    \n    # Create the heatmap\n    heatmap <- ggplot(melt(corr_matrix), aes(Var1, Var2, fill = value)) +\n      geom_tile(color = \"white\") +\n      scale_fill_gradient2(\n        low = \"darkblue\", mid = \"white\", high = \"darkred\", midpoint = 0, \n        limit = c(-1, 1), name = \"Correlation\"\n      ) +\n      labs(\n        title = paste(\"Correlation Heatmap for\", attack),\n        x = \"Variables\",\n        y = \"Variables\"\n      ) +\n      theme_minimal() +\n      theme(\n        axis.text.x = element_text(angle = 90, hjust = 1, size = 10),\n        axis.text.y = element_text(size = 10),\n        plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\")\n      )\n    \n    # Print the heatmap\n    print(heatmap)\n  }\n}\n```\n\n::: {.cell-output-display}\n![](Q3_files/figure-html/Heatmaps for Each Attack Type-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Q3_files/figure-html/Heatmaps for Each Attack Type-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Q3_files/figure-html/Heatmaps for Each Attack Type-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Q3_files/figure-html/Heatmaps for Each Attack Type-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Q3_files/figure-html/Heatmaps for Each Attack Type-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Q3_files/figure-html/Heatmaps for Each Attack Type-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Q3_files/figure-html/Heatmaps for Each Attack Type-7.png){width=672}\n:::\n:::\n\n\n\n### Analysis :-\n\n**1. ARP_Poisoning**\n\n**Variable Interaction:** Strong correlation between bwd_pkts_tot and flow_pkts_per_sec suggests balanced bidirectional traffic.\n\n**Inference:** ARP poisoning exploits bidirectional communication, emphasizing the importance of packet symmetry in its success.\n\n**2. DDOS_Slowloris**\n\n**Variable Interaction:** Weak correlations across all bandwidth and flow metrics.\n\n**Inference:** Interaction between low bandwidth, small payloads, and long durations indicates a resource-depleting strategy without significant data transfer.\n\n**3. DOS_SYN_Hping**\n\n**Variable Interaction:** High correlation between fwd_pkts_per_sec and fwd_pkts_tot.\n\n**Inference:** This attack relies on large volumes of forward packets to overwhelm servers, showing a direct relationship between packet frequency and attack intensity.\n\n**4. Metasploit_Brute_Force_SSH**\n\n**Variable Interaction:** Correlation between flow_duration and fwd_pkts_payload.avg highlights persistence.\n\n**Inference:** The attack uses sustained sessions with consistent payloads, emphasizing authentication cracking through repetitive probes.\n\n**5. MQTT_Publish**\n\n**Variable Interaction:** High correlation between fwd_pkts_payload.max and fwd_pkts_per_sec reflects optimized payload delivery.\n\n**Inference:** MQTT_Publish exploits efficiency in payload delivery, highlighting its IoT application focus.\n\n**6. Thing_Speak**\n\n**Variable Interaction:** Weak overall correlations, but moderate between bwd_pkts_tot and fwd_pkts_payload.avg.\n\n**Inference:** Thing_Speak operates with minimal but consistent bidirectional traffic, leveraging IoT protocols for covert data exchanges.\n\n**7. Wipro_Bulb**\n\n**Variable Interaction:** Strong correlation between fwd_pkts_payload.max and flow_pkts_per_sec.\n\n**Inference:** The attack utilizes high variability in payload and packet flow, reflecting erratic patterns aimed at dynamic IoT environments.\n\n## Synthesis of Variable Interactions Across Attack Types:-\n\n**1. Bandwidth Utilization:**\n\nHigh flow_pkts_per_sec correlates with volumetric attacks like DOS_SYN_Hping, which focus on resource saturation. Low but steady flow rates signify targeted, resource-depleting attacks (e.g., DDOS_Slowloris).\n\n**2. Temporal Manipulation:**\n\nfwd_iat.avg is a defining characteristic for attacks like Slowloris, which exploit high inter-arrival times to hold server resources.\n\n**3. Payload Dynamics:**\n\nVariability in fwd_pkts_payload.max reflects attack adaptability. Static payloads indicate systematic attacks (e.g., Metasploit_Brute_Force_SSH), while dynamic payloads (e.g., Wipro_bulb) signify flexible, IoT-specific threats.\n\n**4. Bidirectional Traffic:**\n\nCorrelations between bwd_pkts_tot and fwd_pkts_tot highlight the reliance on bidirectional traffic for attacks like ARP_poisoning, which exploit network routing vulnerabilities.\n\n**5.Attack Fingerprinting:**\n\nEach attack type displays unique interaction patterns among variables, creating distinct signatures. These can inform the development of targeted anomaly detection systems.\n\n## Conclusion\n\nThe interaction of variables such as bandwidth, payload, and inter-arrival time during an attack provides critical insights into the mechanisms and intent of various attack types on IoT devices. High bandwidth and rapid packet flows signify volumetric attacks, while prolonged inter-arrival times suggest resource-exhausting tactics. Variable correlations, like those observed in payload size and flow rates, underline the adaptability and stealth of IoT-targeted attacks.\n\n**Significance: Understanding these interactions allows for:**\n\n**Attack Fingerprinting:** Identifying unique behavioral signatures for each attack.\n\n**Anomaly Detection:** Designing systems that leverage these patterns for early detection.\n\n**IoT-Specific Defenses:** Developing tailored security protocols for IoT environments, accounting for their unique traffic and payload characteristics.\n\n**Limitation:** Hence the actual source and destination wasnt included in the dataset the Identification of source of attack cannot be determined which undermines anamoly detection.\n\nThis analysis provides a foundation for developing advanced, adaptive intrusion detection systems (IDS) tailored to IoT environments.\n",
    "supporting": [
      "Q3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}